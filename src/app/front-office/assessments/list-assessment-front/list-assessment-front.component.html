<div class="list-assessment-container">
  <app-header-front></app-header-front>
  <button class="back" (click)="goBack()">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
      <path d="M11.854 2.146a.5.5 0 0 1 0 .708L5.707 8l6.147 5.146a.5.5 0 0 1-.708.708l-6.5-6a.5.5 0 0 1 0-.708l6.5-6a.5.5 0 0 1 .708 0z"/>
    </svg>
  </button>
   <div class="header-container">
    <ng-container *ngIf="currentUser?.role === 'CUSTOMER'; else listAssessmentsTitle">
      <h3>My Assessments</h3>
    </ng-container>
    <ng-template #listAssessmentsTitle>
      <h3>List Assessments</h3>
    </ng-template>
        <div class="header-actions">
        <!-- Search -->
        <input 
          type="text" 
          placeholder="Search by ID or Date" 
          [(ngModel)]="searchQuery" 
          (input)="applySearch()" 
          class="search-input" />
  
        <!-- Sort Options -->
        <select [(ngModel)]="selectedSort" (change)="applySort()" class="sort-select">
          <option value="assessmentDate">Sort by Date</option>
          <option value="id">Sort by ID</option>
        </select>
  
        <!-- Sort Direction Toggle -->
        <button class="btn btn-info" (click)="toggleSortDirection()">
          {{ sortDirection ? 'Sort Descending' : 'Sort Ascending' }}
        </button>
        
        <button 
        *ngIf="isAgent() || isAdmin()" 
        class="btn btn-success" 
        (click)="navigateToAddAssessment()">
        Add Assessment
        </button>
      </div>
    </div>
  
    <table class="table">
      <thead>
        <tr>
          <th>Assessment Date</th>
          <th>Findings</th>
          <th>Status</th>
          <th>Final Decision</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let assessment of filteredAssessments; let i = index">
          <td>{{ assessment.assessmentDate | date:'yyyy-MM-dd' }}</td>
          <td>{{ assessment.findings }}</td>
          <td>{{ assessment.statusAssessment }}</td>
          <td>{{ assessment.finalDecision }}</td>
          <td class="actions">
            <button class="btn btn-primary btn-sm" (click)="viewAssessment(assessment.idAssessment)">View</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <app-chatbot></app-chatbot> 
  <app-footer-front></app-footer-front>
