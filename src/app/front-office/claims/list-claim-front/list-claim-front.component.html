<div class="list-claim-container">
    <app-header-front></app-header-front>
    <main class="main-content">
        <div class="header-container">
            <h1 *ngIf="currentUser?.role === 'CUSTOMER'; else adminOrAgentTitle">My Claims</h1>
            <ng-template #adminOrAgentTitle>
              <h1>List Claims</h1>
            </ng-template>
            
            <div class="filter-row">
                <div class="search-container">
                  <input 
                    type="text" 
                    placeholder="Search Claims" 
                    [(ngModel)]="searchQuery" 
                    (input)="applySearch()" 
                    class="search-input" />
                  
                  <select [(ngModel)]="selectedSort" (change)="applySort()" class="sort-select">
                    <option value="" disabled selected>Select Sort Option</option> 
                    <option value="name">Sort by Claim Name</option>
                    <option value="date">Sort by Full Name</option>
                    <option value="date">Sort by Date</option>
                  </select>
                </div>
                
                <div class="action-buttons">
                  <button *ngIf="isCustomer() || isAdmin()" class="btn btn-add" (click)="navigateToAddClaim()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                      <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    Add Claim
                  </button>
              
                  <button *ngIf="isCustomer()" class="btn btn-secondary" (click)="navigateToAssessments()">
                    My Assessments
                  </button>
              
                  <button *ngIf="isAdmin() || isAgent()" class="btn btn-secondary" (click)="navigateToAssessments()">
                    All Assessments
                  </button>
              
                  <button class="btn btn-stats" (click)="toggleStatistics()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                      <path d="M1 11a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3zm5-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm5-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V2z"/>
                    </svg>
                    Statistics
                  </button>
                </div>
              </div>
              </div>


        <div class="claims-grid">
            <div class="claim-card" *ngFor="let claim of filteredClaims | paginate: { itemsPerPage: pageSize, currentPage: page }; let i = index" [@cardAnimation]>
                <div class="claim-card-header">
                    <div class="status-badge" [ngClass]="getStatusClass(claim.statusClaim)">{{ claim.statusClaim }}</div>
                    <h3>{{ claim.fullName }}</h3>
                    <p class="claim-title">{{ claim.claimName }}</p>
                </div>
                <div class="claim-card-body">
                    <div class="claim-info">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
                        </svg>
                        <span>{{ claim.submissionDate | date:'mediumDate' }}</span>
                    </div>
                </div>
                <div class="claim-card-footer">
                    <button class="btn-action view" (click)="viewClaim(claim.idClaim)" title="View Details">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM8 12.5c-2.485 0-4.5-2.015-4.5-4.5S5.515 3.5 8 3.5s4.5 2.015 4.5 4.5-2.015 4.5-4.5 4.5z"/>
                            <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5z"/>
                        </svg>
                    </button>
                  
                    <button *ngIf="isCustomer() || isAdmin()" class="btn-action edit" (click)="editClaim(claim.idClaim)" title="Edit">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M15.502 1.94a.5.5 0 0 1 0 .707l-1.768 1.768-2.121-2.122 1.768-1.768a.5.5 0 0 1 .707 0l1.414 1.415z"/>
                            <path d="M1 13.5V16h2.5l9.646-9.646-2.121-2.122L1 13.5z"/>
                        </svg>
                    </button>
                  
                    <button *ngIf="isCustomer() || isAdmin()" class="btn-action delete" (click)="deleteClaim(claim.idClaim)" title="Delete">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M6 1v1H3v1h10V2h-3V1H6zm1 3v9h2V4H7zm-3 0h1v9H4V4zm7 0h1v9h-1V4z"/>
                        </svg>
                    </button>
                  
                    <button class="btn-action assess" (click)="viewAssessment(claim.idClaim)" title="Assessment">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                            <path d="M10.97 4.97a.75.75 0 0 1 1.071 1.05l-3.992 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.235.235 0 0 1 .02-.022z"/>
                        </svg>
                    </button>
                </div>              
            </div>
        </div>

        <div class="pagination-container">
            <pagination-controls (pageChange)="page = $event" 
                                previousLabel="Previous"
                                nextLabel="Next"
                                screenReaderPaginationLabel="Pagination"
                                screenReaderPageLabel="page"
                                screenReaderCurrentLabel="You're on page">
            </pagination-controls>
        </div>
    </main>

    <div *ngIf="showStatistics" class="stats-container" @fadeInOut>
        <h2>Claims Statistics</h2>
        <div class="stats-grid">
            <div class="stat-card" *ngFor="let stat of statsData" @statCard>
                <div class="stat-circle" [style.background]="stat.color">
                    <span class="stat-count">{{ stat.count }}</span>
                </div>
                <p class="stat-label">{{ stat.label }}</p>
                <div class="stat-tooltip">{{ stat.description }}</div>
            </div>
        </div>
        <button class="close-stats" (click)="toggleStatistics()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
            </svg>
        </button>
    </div>
</div>

<app-chatbot></app-chatbot> 
<app-footer-front></app-footer-front>